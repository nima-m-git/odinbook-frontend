(this["webpackJsonpodinbook-frontend"]=this["webpackJsonpodinbook-frontend"]||[]).push([[0],{34:function(e,t,n){},42:function(e,t,n){},61:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n(1),a=n(35),r=n.n(a),i=n(8),o=(n(42),n(5)),l=n(2),u=n(4),d=n(3),j=n.n(d),b=(n(61),function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){j.a.defaults.baseURL="https://damp-anchorage-97572.herokuapp.com/"}),[]),Object(s.jsx)("div",{className:"app",children:n?Object(s.jsxs)("div",{children:[Object(s.jsx)(v,{logout:function(){return a(!1)}}),Object(s.jsx)("div",{className:"container",children:Object(s.jsxs)(u.c,{children:[Object(s.jsx)(u.a,{path:["/","/posts"],exact:!0,children:Object(s.jsx)(_,{})}),Object(s.jsx)(u.a,{path:"/posts/:postId",children:Object(s.jsx)(I,{})}),Object(s.jsx)(u.a,{path:"/users",exact:!0,children:Object(s.jsx)(D,{})}),Object(s.jsx)(u.a,{path:"/users/:userId",children:Object(s.jsx)(A,{})})]})})]}):Object(s.jsx)(h,Object(o.a)({},{setHeaders:function(e){j.a.defaults.headers.common.Authorization="Bearer ".concat(e),a(!0)}}))})}),m=(n(67),n(14)),p=n(18),O=function(e){var t=e.closePopup,n=Object(c.useState)([]),a=Object(l.a)(n,2),r=a[0],i=a[1],u=Object(c.useState)(null),d=Object(l.a)(u,2),b=d[0],O=d[1],h=Object(c.useState)({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",image:null}),f=Object(l.a)(h,2),v=f[0],x=f[1],g=function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},Object(p.a)({},e.target.name,"image"===e.target.name?e.target.files[0]:e.target.value))}))};return Object(s.jsxs)("form",{className:"signup-form",onSubmit:function(e){e.preventDefault();var n=new FormData;for(var s in v)n.append([s],v[s]);j.a.post("/signup",n,{}).then((function(e){O(null===e||void 0===e?void 0:e.data.message),(null===e||void 0===e?void 0:e.errors)?i(Object(m.a)(null===e||void 0===e?void 0:e.errors)):(i([]),setTimeout((function(){return t()}),1e3))})).catch((function(e){var t,n;console.log(e.response.data.err||e.response),i(Object(m.a)(null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.errors)||e.response)}))},encType:"multipart/form-data",children:[Object(s.jsx)("h2",{className:"form-title",children:"Signup"}),Object(s.jsx)("img",{className:"exit-btn",src:"https://static.xx.fbcdn.net/rsrc.php/v3/yX/r/TdCEremeWv5.png",alt:"",onClick:t}),r.map((function(e,t){return Object(s.jsxs)("div",{className:"error",children:["- ",e.msg]},t)})),b&&Object(s.jsx)("div",{className:"message",children:b}),Object(s.jsx)("div",{className:"line"}),Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"text",name:"firstName",value:v.firstName,onChange:g,placeholder:"First Name"})}),Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"text",name:"lastName",value:v.lastName,onChange:g,placeholder:"Last Name"})}),Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"email",name:"email",value:v.email,onChange:g,placeholder:"Email"})}),Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"password",name:"password",value:v.password,onChange:g,placeholder:"Password"})}),Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"password",name:"confirmPassword",value:v.confirmPassword,onChange:g,placeholder:"Confirm Password"})}),Object(s.jsxs)("label",{children:["Profile Picture",Object(s.jsx)("input",{type:"file",name:"image",onChange:g})]}),Object(s.jsx)("button",{type:"submit",className:"signup-btn",children:"Sign Up"})]})},h=function(e){var t=e.setHeaders,n=Object(c.useState)(""),a=Object(l.a)(n,2),r=a[0],i=a[1],o=Object(c.useState)(""),u=Object(l.a)(o,2),d=u[0],b=u[1],m=Object(c.useState)(null),p=Object(l.a)(m,2),h=p[0],f=p[1],v=Object(c.useState)(!1),x=Object(l.a)(v,2),g=x[0],N=x[1];return Object(s.jsxs)("div",{className:"login",children:[Object(s.jsx)("header",{children:"Nimabook"}),g?Object(s.jsx)(O,{closePopup:function(){return N(!1)}}):Object(s.jsxs)("form",{className:"login-form",onSubmit:function(e){e.preventDefault(),j.a.post("/login",{email:r,password:d}).then((function(e){var n,s;f(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message);var c=null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.token;c&&t(c)})).catch((function(e){return console.log(e.response||e)}))},children:[h&&Object(s.jsxs)("div",{className:"error",children:["- ",h]}),Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"email",name:"email",value:r,onChange:function(e){return i(e.target.value)},placeholder:"Email"})}),Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"password",name:"password",value:d,onChange:function(e){return b(e.target.value)},placeholder:"Password"})}),Object(s.jsx)("button",{className:"submit-btn",children:"Log In"}),Object(s.jsx)("div",{className:"line"}),Object(s.jsx)("button",{type:"button",className:"signup-btn",onClick:function(){return N(!0)},children:"Sign Up"})]})]})},f=(n(68),function(e){return"data:image/jpeg;base64,".concat(e)}),v=function(e){var t=e.logout,n=Object(c.useState)(!0),a=Object(l.a)(n,2),r=a[0],o=a[1];return Object(c.useEffect)((function(){j.a.get("/users/me").then((function(e){var t=e.data.user;(null===t||void 0===t?void 0:t.image)&&(t.image=f(t.image.image.data)),o(t)})).catch((function(e){var t,n;return console.log((null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.err)||e.request)}))}),[]),Object(s.jsxs)("header",{className:"header",children:[Object(s.jsx)(i.b,{to:"/",children:Object(s.jsx)("header",{children:Object(s.jsx)("h1",{className:"logo",children:"Nimabook"})})}),Object(s.jsxs)("nav",{className:"navbar",children:[Object(s.jsx)(i.b,{className:"link",to:"/users",children:"Users"}),Object(s.jsx)(i.b,{className:"link",to:"/users/".concat(r._id),children:(null===r||void 0===r?void 0:r.image)&&Object(s.jsxs)("div",{className:"profilePic",children:[Object(s.jsx)("div",{className:"usersName",children:r.fullName}),Object(s.jsx)("img",{src:(null===r||void 0===r?void 0:r.image)||"/empty_profile.png",alt:"profile pic",width:"50",height:"50"})]})}),Object(s.jsx)("div",{className:"link",onClick:t,children:"Logout"})]})]})},x=n(11),g=n.n(x),N=n(13),k=n(3).default,S=n(20).useState,w=function(e){var t=e.refresh,n=S(""),c=Object(l.a)(n,2),a=c[0],r=c[1],i=S(null),o=Object(l.a)(i,2),u=o[0],d=o[1],j=S(null),b=Object(l.a)(j,2),m=b[0],p=b[1],O=function(){var e=Object(N.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,k.post("/posts/",{content:a}).then((function(e){return p(e.data.msg)})).catch((function(e){return d(e.response.data.err)}));case 3:r(""),t();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("form",{className:"postForm",onSubmit:O,children:[Object(s.jsx)("label",{children:Object(s.jsx)("textarea",{onChange:function(e){return r(e.target.value)},value:a,rows:2,maxLength:500,placeholder:"Whats on your mind?"})}),Object(s.jsx)("button",{className:"submit-btn",children:"Submit"}),m&&Object(s.jsx)("div",{className:"message",children:m}),u&&Object(s.jsx)("div",{className:"error",children:u})]})},y=function(e){var t=e.postId,n=e.refresh,a=Object(c.useState)(""),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(c.useState)([]),d=Object(l.a)(u,2),b=d[0],p=d[1],O=function(){var e=Object(N.a)(g.a.mark((function e(s){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,j.a.post("/posts/".concat(t),{content:i}).then((function(e){var t;p((null===(t=e)||void 0===t?void 0:t.errors)?t.errors.map((function(e){return e.msg})):(null===t||void 0===t?void 0:t.err)?[t.err]:[])})).catch((function(e){return p([].concat(Object(m.a)(b),[e.response.data.err]))}));case 3:o(""),n();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("form",{className:"comment-box",onSubmit:O,children:[Object(s.jsxs)("label",{children:["Reply:",Object(s.jsx)("textarea",{onChange:function(e){return o(e.target.value)},value:i,rows:1,cols:40,maxLength:300})]}),Object(s.jsx)("button",{className:"submit-btn",children:"Submit"}),b&&b.map((function(e){return Object(s.jsx)("div",{className:"error",children:e})}))]})},C=function(e){var t=e.post;return Object(s.jsx)("div",{className:"expanded-likes",children:null===t||void 0===t?void 0:t.likes.map((function(e,t){return Object(s.jsx)("li",{children:e.fullName},t)}))})},P=function(e){var t,n,a=e.refresh,r=e.post,u=Object(c.useState)(!1),d=Object(l.a)(u,2),b=d[0],p=d[1],O=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,j.a.post("/posts/".concat(r._id,"/like")).then((function(e){return console.log(e.data.msg)}));case 4:a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"post",children:[Object(s.jsxs)("div",{className:"post-info",children:[Object(s.jsx)(i.b,{to:"/users/".concat(r.author._id),children:Object(s.jsxs)("div",{className:"profilePic",children:[Object(s.jsx)("div",{className:"author",children:r.author.fullName}),(null===(t=r.author)||void 0===t?void 0:t.image)&&Object(s.jsx)("img",{src:f(r.author.image)||"https://fertilitynetworkuk.org/wp-content/uploads/2017/01/Facebook-no-profile-picture-icon-620x389.jpg",alt:"profile pic",width:"50"})]})}),Object(s.jsx)("p",{className:"content",children:r.content}),Object(s.jsxs)("div",{className:"flex-bar",children:[Object(s.jsx)("button",{className:"like",onClick:O,children:r.liked?"unlike":"like"}),Object(s.jsxs)("div",{className:"likes",children:[Object(s.jsxs)("button",{className:"number-likes",onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)},children:["Likes (",(null===r||void 0===r||null===(n=r.likes)||void 0===n?void 0:n.length)||"0",")"]}),b&&Object(s.jsx)(C,Object(o.a)({},{post:r}))]})]})]}),Object(s.jsxs)("div",{className:"comments",children:[Object(s.jsx)(y,Object(o.a)(Object(o.a)({},{refresh:a}),{},{postId:r._id})),r.comments&&Object(m.a)(r.comments).sort((function(e,t){return e.dateAdded>t.dateAdded?1:-1})).map((function(e){var t;return Object(s.jsxs)("div",{className:"comment",children:[Object(s.jsx)("div",{className:"author",children:null===e||void 0===e||null===(t=e.author)||void 0===t?void 0:t.fullName}),Object(s.jsx)("p",{className:"content",children:e.content})]},e._id)}))]})]})},_=(n(34),function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(null),i=Object(l.a)(r,2),u=i[0],d=i[1],b=Object(c.useCallback)((function(){j.a.get("/posts").then((function(e){a(e.data.posts),d(null===e||void 0===e?void 0:e.data.err)})).catch((function(e){return d(e)}))}),[]);return Object(c.useEffect)((function(){b()}),[b]),Object(s.jsxs)("div",{className:"posts-container",children:[u&&Object(s.jsx)("div",{className:"error",children:u}),Object(s.jsx)(w,{refresh:b}),n.map((function(e){return Object(c.createElement)(P,Object(o.a)(Object(o.a)({},{post:e}),{},{refresh:b,key:e._id}))}))]})}),E=n(20),I=function(){var e=Object(E.useState)(),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(E.useState)(null),i=Object(l.a)(r,2),d=i[0],b=i[1],m=Object(u.f)().postId,p=function(){j.a.get("/posts/".concat(m)).then((function(e){a(e.post),b(null===e||void 0===e?void 0:e.err)})).catch((function(e){return b(e)}))};return Object(c.useEffect)((function(){p()})),Object(s.jsxs)("div",{className:"post-container",children:[d&&Object(s.jsx)("div",{className:"error",children:d}),n.map((function(e){return Object(s.jsx)(P,Object(o.a)(Object(o.a)({},{post:e}),{},{refresh:p}))}))]})},F=(n(70),function(e){var t=e.user,n=Object(c.useState)(null),a=Object(l.a)(n,2),r=a[0],o=a[1],u=Object(c.useState)(null),d=Object(l.a)(u,2),b=d[0],m=d[1],p=function(e){j.a.put("/users/requests/".concat(t._id),{requestResponse:e}).then((function(e){o(null===e||void 0===e?void 0:e.data.msg)})).catch((function(e){m(e.response.data.msg),console.log(e.response)}))};return Object(s.jsxs)("div",{className:"user-card",children:[r&&Object(s.jsx)("div",{className:"message",children:r}),b&&Object(s.jsx)("div",{className:"error",children:b}),Object(s.jsx)("div",{className:"profilePic",children:Object(s.jsx)("img",{src:(null===t||void 0===t?void 0:t.image)||"/empty_profile.png",alt:"profile pic",height:50,width:50})}),Object(s.jsxs)("div",{className:"profileInfo",children:[Object(s.jsx)(i.b,{to:"/users/".concat(t._id),children:Object(s.jsx)("div",{className:"name",children:null===t||void 0===t?void 0:t.fullName})}),Object(s.jsx)("div",{className:"status",children:function(e){switch(e){case"denied":case void 0:return Object(s.jsx)("button",{type:"button",className:"addFriend-status",onClick:function(){return e=t._id,void j.a.post("/users/requests/".concat(e)).then((function(e){var t;o(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg)})).catch((function(e){m(e.response.data.msg),console.log(e.response)}));var e},children:"Add Friend"});case"received":return Object(s.jsxs)("div",{className:"respondFriend-status",children:[Object(s.jsx)("button",{type:"button",className:"confirmFriend-status",onClick:function(){return p("accepted")},children:"Confirm"}),Object(s.jsx)("button",{type:"button",className:"rejectFriend-status",onClick:function(){return p("denied")},children:"Reject"})]});case"accepted":return Object(s.jsx)("button",{type:"button",className:"friends-status",children:"Friends"});case"pending":return Object(s.jsx)("button",{type:"button",className:"pending-status",children:"Pending.."});default:return Object(s.jsx)("button",{type:"button",className:"no-status"})}}(t.friendsStatus)}),Object(s.jsx)("br",{})]})]})}),D=function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(null),i=Object(l.a)(r,2),u=i[0],d=i[1],b=Object(c.useCallback)((function(){j.a.get("/users").then((function(e){e.data.users.forEach((function(e){(null===e||void 0===e?void 0:e.image)&&(e.image=f(e.image.image.data))})),a(e.data.users),d(null===e||void 0===e?void 0:e.data.err)})).catch((function(e){var t,n;return d((null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.err)||(null===e||void 0===e?void 0:e.response))}))}),[]);return Object(c.useEffect)((function(){b()}),[b]),Object(s.jsxs)("div",{className:"users-container",children:[u&&Object(s.jsx)("div",{className:"error",children:u}),n&&n.map((function(e){return Object(c.createElement)(F,Object(o.a)(Object(o.a)({},{user:e}),{},{refresh:b,key:e._id}))}))]})},L=n(3).default,R=n(1).useState,q=function(e){var t=e.exit,n=e.refresh,c=e.priorImage,a=R(null),r=Object(l.a)(a,2),i=r[0],o=r[1],u=R(!1),d=Object(l.a)(u,2),j=d[0],b=d[1],m=R(""),p=Object(l.a)(m,2),O=p[0],h=p[1],f=R(null),v=Object(l.a)(f,2),x=v[0],g=v[1];return Object(s.jsxs)("form",{className:"updateImage",onSubmit:function(e){e.preventDefault();var s=new FormData;i&&s.append("image",i),j&&s.append("remove-image",!0),L.put("/users/update_image",s,{}).then((function(e){var s;h(null===(s=e.data)||void 0===s?void 0:s.msg),t(),n()})).catch((function(e){var t,n;console.log(e.response),g((null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.err)||e.response)}))},encType:"multipart/form-data",children:[O&&Object(s.jsx)("div",{className:"message",children:O}),x&&Object(s.jsx)("div",{className:"error",children:x}),Object(s.jsxs)("label",{children:["Profile Picture",Object(s.jsx)("input",{type:"file",name:"image",onChange:function(e){return o(e.target.files[0])}})]}),c&&Object(s.jsx)("button",{type:"submit",onClick:function(){return b(!0)},children:"Remove Current Image"}),Object(s.jsx)("button",{type:"submit",children:"Submit"})]})},A=function(){var e=Object(u.f)().userId,t=Object(c.useState)(null),n=Object(l.a)(t,2),a=n[0],r=n[1],i=Object(c.useState)(null),d=Object(l.a)(i,2),b=d[0],m=d[1],p=Object(c.useState)(!1),O=Object(l.a)(p,2),h=O[0],v=O[1],x=Object(c.useState)(!1),k=Object(l.a)(x,2),S=k[0],w=k[1],y=Object(c.useCallback)(Object(N.a)(g.a.mark((function t(){var n,s,c,a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.a.get("/users/".concat(e));case 3:return(null===(n=t.sent.data.user)||void 0===n?void 0:n.image)&&(n.image=f(n.image.image.data)),t.next=7,j.a.get("/users/me");case 7:s=t.sent.data.user,v(s._id===n._id),r(n),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),m((null===(c=t.t0.response)||void 0===c||null===(a=c.data)||void 0===a?void 0:a.err)||t.t0.response);case 15:case"end":return t.stop()}}),t,null,[[0,12]])}))),[e]);return Object(c.useEffect)((function(){return y()}),[y]),Object(s.jsxs)("div",{className:"userPage",children:[h&&S&&Object(s.jsx)(q,{exit:function(){return w(!1)},refresh:y,priorImage:!!a.image}),b&&Object(s.jsx)("div",{className:"error",children:b}),a&&Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{className:"profilePic",onClick:function(){return w(!0)},children:Object(s.jsx)("img",{src:(null===a||void 0===a?void 0:a.image)||"/empty_profile.png",alt:"profile pic",width:"80"})}),Object(s.jsx)("div",{className:"fullName",children:a.fullName}),Object(s.jsx)("div",{className:"posts-container",children:a.posts.length>0?a.posts.map((function(e){return Object(c.createElement)(P,Object(o.a)(Object(o.a)({},{post:e}),{},{refresh:y,key:e._id}))})):Object(s.jsx)("p",{children:"No posts to show"})})]})]})};r.a.render(Object(s.jsx)(i.a,{children:Object(s.jsx)(b,{})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.3072630f.chunk.js.map